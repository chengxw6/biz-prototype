<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的订单 - 业务下单系统</title>
    <link rel="stylesheet" href="/assets/style.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">业务下单系统</div>
            <ul class="sidebar-nav">
                <li><a href="/order/products.html">申请新证书</a></li>
                <li><a href="/order/list.html">我的订单</a></li>
                <li><a href="/certificate/list.html">我的证书</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <header class="header">
                <div class="user-menu">
                    <button class="user-menu-button" id="userMenuButton">
                        <span>个人账户: 张三</span>
                        <i class="arrow"></i>
                    </button>
                    <div class="user-menu-dropdown" id="userMenuDropdown">
                        <div class="dropdown-header">切换账户</div>
                        <a href="#" class="dropdown-item">✓ 个人账户: 张三</a>
                        <a href="#" class="dropdown-item">机构账户: 示例科技有限公司</a>
                        <div class="dropdown-divider"></div>
                        <a href="/account/profile.html" class="dropdown-item">账户信息修改</a>
                        <a href="/account/login.html" class="dropdown-item">退出登录</a>
                    </div>
                </div>
            </header>
            
            <div class="page-header">
                <h1>我的订单</h1>
            </div>
            <div class="card">
                <div class="card-header">订单列表</div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>订单号</th>
                                <th>证书申请明细</th>
                                <th>订单金额</th>
                                <th>支付状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 单个订单示例 -->
                            <tr>
                                <td><a href="#">ORD20250715001</a></td>
                                <td>
                                    <div>
                                        APP-EVSSL-001: 電子證書（伺服器）
                                        <button class="btn btn-link toggle-details" data-target="details-1">更多</button>
                                    </div>
                                    <div id="details-1" class="details hidden">
                                        <ul>
                                            <li>APP-PER-00862: 電子證書（個人）</li>
                                            <li>APP-ORG-00543: 電子證書（機構）</li>
                                        </ul>
                                    </div>
                                </td>
                                <td>HK$ 5,000.00</td>
                                <td><span class="status-badge status-paid">已支付</span></td>
                                <td>
                                    <div class="dropdown">
                                        <button class="btn btn-link dropdown-toggle">查看详情</button>
                                        <div class="dropdown-menu">
                                            <a href="#" class="dropdown-item">支付订单</a>
                                            <a href="#" class="dropdown-item">取消订单</a>
                                            <a href="#" class="dropdown-item">编辑订单</a>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <!-- 群体订单示例 -->
                            <tr>
                                <td><a href="#">ORD20250715002</a></td>
                                <td>
                                    <div>
                                        APP-ORG-00543: 電子證書（機構）
                                        <button class="btn btn-link toggle-details" data-target="details-2">更多</button>
                                    </div>
                                    <div id="details-2" class="details hidden">
                                        <ul>
                                            <li>APP-ORG-00544: 電子證書（機構）互認版</li>
                                            <li>APP-ORG-00545: 電子證書（保密）</li>
                                        </ul>
                                    </div>
                                </td>
                                <td>HK$ 10,000.00</td>
                                <td><span class="status-badge status-unpaid">未支付</span></td>
                                <td>
                                    <div class="dropdown">
                                        <button class="btn btn-link dropdown-toggle">查看详情</button>
                                        <div class="dropdown-menu">
                                            <a href="#" class="dropdown-item">支付订单</a>
                                            <a href="#" class="dropdown-item">取消订单</a>
                                            <a href="#" class="dropdown-item">编辑订单</a>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>
    <script src="/assets/main.js"></script>
  <script>
document.addEventListener('DOMContentLoaded', () => {
    // --- 1. 通用顶部用户菜单逻辑 ---
    const userMenuButton = document.getElementById('userMenuButton');
    const userMenuDropdown = document.getElementById('userMenuDropdown');
    if (userMenuButton && userMenuDropdown) {
        userMenuButton.addEventListener('click', (event) => {
            event.stopPropagation(); // 防止点击事件冒泡到document
            userMenuDropdown.classList.toggle('show');
        });

        // 点击页面其他地方关闭菜单
        document.addEventListener('click', (event) => {
            if (!userMenuButton.contains(event.target)) {
                userMenuDropdown.classList.remove('show');
            }
        });
    }

    // --- 2. “我的订单”页面的“更多”详情展开/收起逻辑 ---
    const toggleDetailsButtons = document.querySelectorAll('.toggle-details');
    toggleDetailsButtons.forEach(button => {
        button.addEventListener('click', () => {
            const targetId = button.dataset.target;
            const detailsElement = document.getElementById(targetId);
            if (detailsElement) {
                const isHidden = detailsElement.classList.toggle('hidden');
                button.textContent = isHidden ? '更多' : '收起';
            }
        });
    });

    // --- 3. 表格内所有下拉菜单的通用逻辑 (适用于“查看详情”和“管理”按钮) ---
    const allDropdownToggles = document.querySelectorAll('.dropdown-toggle, .manage-btn');
    allDropdownToggles.forEach(toggle => {
        toggle.addEventListener('click', (event) => {
            event.stopPropagation();
            // 先关闭所有其他已打开的菜单
            document.querySelectorAll('.dropdown-menu, .manage-menu').forEach(menu => {
                // 如果不是当前点击的这个菜单，就关闭它
                if (!toggle.nextElementSibling.isSameNode(menu)) {
                    menu.classList.remove('show');
                }
            });
            // 切换当前点击的菜单
            const menu = toggle.nextElementSibling;
            if (menu) {
                menu.classList.toggle('show');
            }
        });
    });

    // 点击页面其他地方，关闭所有表格内的下拉菜单
    document.addEventListener('click', (event) => {
        if (!event.target.closest('.dropdown, .manage-dropdown')) {
            document.querySelectorAll('.dropdown-menu, .manage-menu').forEach(menu => {
                menu.classList.remove('show');
            });
        }
    });
});
</script>
</body>
</html>